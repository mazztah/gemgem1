<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Snake-Spiel mit 360Â°-Bewegung und Touch-Steuerung</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      user-select: none;
      overflow: hidden;
    }
    canvas {
      background: #222;
      border: 2px solid #555;
      touch-action: none;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="1200" height="800"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const cellSize = 20;
    const gridWidth = canvas.width / cellSize;
    const gridHeight = canvas.height / cellSize;
    const TICK_INTERVAL = 150;
    const TARGET_APPLE_COUNT = 50;
    const MAX_BOTS = 10;
    const BOT_SPAWN_INTERVAL = 15000;
    const APPLE_IMAGE_SRC = "https://i.ibb.co/YTfFdFqZ/7e89b4f2-893c-4024-95ec-0e8d43cca844.png";
    const APPLE_SIZE = 15;

    let apples = [];
    let bots = [];
    let gameOver = false;
    let lastBotSpawnTime = Date.now();

    let player = {
      snake: [
        { x: Math.floor(gridWidth / 2), y: Math.floor(gridHeight / 2) },
        { x: Math.floor(gridWidth / 2) - 1, y: Math.floor(gridHeight / 2) },
        { x: Math.floor(gridWidth / 2) - 2, y: Math.floor(gridHeight / 2) }
      ],
      direction: { dx: 1, dy: 0 },
      speed: 1,
      score: 0
    };

    const appleImage = new Image();
    appleImage.src = APPLE_IMAGE_SRC;

    function createBot() {
      let startX = Math.floor(Math.random() * gridWidth);
      let startY = Math.floor(Math.random() * gridHeight);
      return {
        snake: [
          { x: startX, y: startY },
          { x: startX - 1, y: startY }
        ],
        direction: { dx: 1, dy: 0 },
        speed: 0.5 + Math.random() * 0.5,
        score: 0
      };
    }

    function spawnApple() {
      let apple = {
        x: Math.floor(Math.random() * gridWidth),
        y: Math.floor(Math.random() * gridHeight)
      };
      apples.push(apple);
    }

    function ensureApples() {
      while (apples.length < TARGET_APPLE_COUNT) {
        spawnApple();
      }
    }

    function initGame() {
      apples = [];
      bots = [];
      ensureApples();
      for (let i = 0; i < 3; i++) {
        bots.push(createBot());
      }
    }

    document.addEventListener("keydown", e => {
      const angleStep = Math.PI / 18;
      switch (e.key) {
        case "ArrowUp":
          player.direction.angle -= angleStep;
          break;
        case "ArrowDown":
          player.direction.angle += angleStep;
          break;
      }
      updateDirection();
    });

    let touchStartX = 0, touchStartY = 0;
    let touchActive = false;

    canvas.addEventListener("touchstart", e => {
      let touch = e.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;
      touchActive = true;
    });

    canvas.addEventListener("touchmove", e => {
      if (!touchActive) return;
      let touch = e.touches[0];
      let dx = touch.clientX - touchStartX;
      let dy = touch.clientY - touchStartY;
      let angle = Math.atan2(dy, dx);
      player.direction = { dx: Math.cos(angle), dy: Math.sin(angle), angle: angle };
      e.preventDefault();
    });

    canvas.addEventListener("touchend", () => {
      touchActive = false;
    });

    function wrapPosition(pos) {
      if (pos.x < 0) pos.x = gridWidth - 1;
      if (pos.x >= gridWidth) pos.x = 0;
      if (pos.y < 0) pos.y = gridHeight - 1;
      if (pos.y >= gridHeight) pos.y = 0;
    }

    function moveSnake(snake, direction, speed, grow) {
      let head = snake[0];
      let newHead = {
        x: head.x + direction.dx * speed,
        y: head.y + direction.dy * speed
      };
      wrapPosition(newHead);
      snake.unshift(newHead);
      if (!grow) snake.pop();
    }

    function updatePlayer() {
      let head = player.snake[0];
      let newHead = {
        x: head.x + player.direction.dx * player.speed,
        y: head.y + player.direction.dy * player.speed
      };
      wrapPosition(newHead);
      let ateApple = false;
      for (let i = 0; i < apples.length; i++) {
        if (Math.hypot(apples[i].x - newHead.x, apples[i].y - newHead.y) < 1) {
          ateApple = true;
          apples.splice(i, 1);
          player.score++;
          break;
        }
      }
      moveSnake(player.snake, player.direction, player.speed, ateApple);
    }

    function updateBots() {
      bots.forEach(bot => {
        let head = bot.snake[0];
        let target = null, minDist = Infinity;
        apples.forEach(apple => {
          let d = Math
::contentReference[oaicite:0]{index=0}
 
